<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{fragments/head :: head}"></div>
<body>
	<div th:replace="~{fragments/nav :: nav}"></div>
	
	<div th:if="${message}"
		class="alert alert-success alert-dismissible fade show" role="alert">
		<span th:text="${message}"></span>
		<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
	</div>

	<div th:if="${error}"
		class="alert alert-danger alert-dismissible fade show" role="alert">
		<span th:text="${error}"></span>
		<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
	</div>

	<section class="container my-4 p-2">
		<div class="row">
			<div class="col-md-4">
				<div class="card profile-card">
					<div class="card-body text-center">
						<div class="mb-3">
							<img th:if="${user.profileImagePath}"
								th:src="@{'/' + ${user.profileImagePath}}"
								class="rounded-circle"
								style="width: 150px; height: 150px; object-fit: cover;"
								th:alt="${user.username}"> <i
								th:unless="${user.profileImagePath}"
								class="bi bi-person-circle text-muted" style="font-size: 150px;"></i>
						</div>
						<h4 th:text="${user.username}"></h4>
						<p class="text-muted" th:text="${user.email}"></p>
						<p class="text-muted">
							Member since <span
								th:text="${#temporals.format(user.createdAt, 'MMMM yyyy')}"></span>
						</p>
					</div>
				</div>
			</div>

			<div class="col-md-8">
				<div class="card profile-card">
					<div class="card-header">
						<h5>
							<i class="bi bi-person-gear"></i> Update Profile
						</h5>
					</div>
					<div class="card-body">
						<form th:action="@{/profile/update}" method="post"
							enctype="multipart/form-data">
							<div class="mb-3">
								<label for="username" class="form-label">Username</label> <input
									type="text" class="form-control" name="username"
									th:value="${user.username}" required>
							</div>

							<div class="mb-3">
								<label for="email" class="form-label">Email</label> <input
									type="email" class="form-control" th:value="${user.email}"
									disabled>
								<div class="form-text">Email cannot be changed</div>
							</div>

							<div class="mb-3">
								<label for="profileImage" class="form-label">Profile
									Image</label> <input type="file" class="form-control"
									name="profileImage" accept="image/*">
								<div class="form-text">Upload a new profile picture (JPG,
									PNG, GIF)</div>
							</div>

							<div class="d-grid">
								<button type="submit" class="btn text-white rounded-4 p-2 mt-3 w-100" style="background-color: #6f42c1;">
									Update Profile
								</button>
							</div>
						</form>
					</div>
				</div>

				<!-- Profile Stats -->
				<div class="card profile-card mt-4">
					<div class="card-header">
						<h5>
							<i class="bi bi-bar-chart"></i> Activity Summary
						</h5>
					</div>
					<div class="card-body">
						<div class="row text-center">
							<div class="col-md-4">
								<div class="border-end">
									<h3 class="text" style="color: #6f42c1;"
										th:text="${#lists.size(user.createdEvents)}">0</h3>
									<p class="text-muted">Events Created</p>
								</div>
							</div>
							<div class="col-md-4">
								<div class="border-end">
									<h3 class="text" style="color: #6f42c1;"
										th:text="${#lists.size(user.eventMemberships)}">0</h3>
									<p class="text-muted">Events Joined</p>
								</div>
							</div>
							<div class="col-md-4">
								<h3 class="text" style="color: #6f42c1;"
									th:text="${#lists.size(user.bookmarks)}">0</h3>
								<p class="text-muted">Events Bookmarked</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<style>
.profile-card:hover {
	box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    transform: none;
}
</style>
	</section>


	<div th:replace="~{fragments/footer :: footer}"></div>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>